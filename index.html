<!-- https://skefflock.github.io/index.html -->
<!-- https://milligram.io/getting-started.html -->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>onRecord</title>
    <script src="https://docs.getgrist.com/grist-plugin-api.js"></script>
    <script src="./api_deps.js"></script>
    <script src="./api.js"></script>
    <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/purecss@3.0.0/build/pure-min.css" integrity="sha384-X38yfunGUhNzHpBaEBsWLO+A0HDYOQi8ufWDkZ0k9e0eXz/tH3II7uKZ9msv++Ls" crossorigin="anonymous"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.css">
    <style>
      body {
        font-size: 1.2rem;
        line-height: 1.0;
        padding-top: 0.2rem !important;
        padding-bottom: 0.2rem !important;
      }
    </style>
  </head>
  <body>
    <table class="pure-table-horizontal">
      <thead>
        <tr>
            <th>Параметр</th>
            <th>Код</th>
            <th>Значение</th>
        </tr>
      </thead>
        <tr>
          <td>Сотрудник</td>
          <td id="employee_id">-</td>
          <td id="employee_name">-</td>
        </tr>
        <tr>
          <td>Проект</td>
          <td id="project_id">-</td>
          <td id="project_name">-</td>
        </tr>
        <tr>
          <td>Работа</td>
          <td id="work_id">-</td>
          <td id="work_name">-</td>
        </tr>
      <tbody>
        
      </tbody>
    </table>

    <p> Версия виджета 0.0.007 </p>
    
    <script>
      grist.ready();

      // получение всей таблицы по названию
      async function getTableById(tableId) {
        const result = await grist.docApi.fetchTable(tableId);
        return result; 
      }

    
      // на изменение выделения привязанной таблицы
      grist.onRecord(function(record) {
        if (!record) {
          document.getElementById('employee').innerHTML = "Выберите запись";
          document.getElementById('project').innerHTML = "";
          document.getElementById('work').innerHTML = "";
        }
        else {
          console.log("-- Вывод содержимого таблицы -----");
          console.log(record);
          console.log("-- Конец вывода ------------------");
          document.getElementById('employee_id').innerHTML = record.employee_id;
          document.getElementById('project_id').innerHTML = record.project_id;
          document.getElementById('work_id').innerHTML = record.id;
        }
      
      });

    </script>
  </body>
</html>
